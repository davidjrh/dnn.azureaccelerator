<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<serviceAccelerator elementFormDefault="qualified" attributeFormDefault="unqualified">
<!--
This source is subject to the Microsoft Permissive License.

Note: Refer to the Application.config file for details on how to use Params and Variables.
-->

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!--          [ DotNetNuke | 5.6.1 ]                                                               -->
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<application name="DotNetNuke" version="5.6.1" description="DotNetNuke Community v5.6.1">
        <!-- 
        PARAMETERS:
        
            DotNetNukeHome:     The location of the DNN physical directory on the uploaded
                             cloud drive.  By default $(IisSiteHome) is the root of the cloud
                             drive.  To override IisSiteHome just add a new param with the 
                             updated value here, or update the definition in the IIS 
                             configuration section below.
                                            
            DotNetNukeAppPath:  The default virtual directory and application root for DotNetNuke.
                             
                             NOTE:  DotNetNuke should be installed at the root of any site.
                             

        CONFIGURATION:
        
            ( Default )
            
                DotNetNukeHome:     $(IisSiteHome)\dotnetnuke
                DotNetNukeAppPath:  /
        
        For advanced configurations refer to the IIS section below.

        -->
<params>
    <param key="DotNetNukeHome"    value="$(IisSiteHome)\dotnetnuke" />
    <param key="DotNetNukeAppPath" value="/" />
    <param key="IisDriveUri"    value="$(AcceleratorDrivePageBlobUri)" />
</params>
    <dependencies>
        <applications>
            <application name="IIS" version="7.5" />
        </applications>
        <validation>
            <fileValidation path="$(DotNetNukeHome)\dotnetnuke\install\install.aspx" 
                            checkAccess="false" 
                            required="true" /> 
        </validation>
    </dependencies>
    <configuration>
        <files>
            <file path="$(DotNetNukeHome)\web.config">
                <regex pattern="(?s)(?&lt;open&gt;&lt;add key=&quot;SiteSqlServer&quot; value=&quot;)(?&lt;mode&gt;.+?)(?&lt;close&gt;&quot;.*?/&gt;)"                       
                       replacement="${open}$(DatabaseConnectionString)${close}"
                       evalVariablesInPattern="true"
                       evalVariablesInReplacement="true" /> 
                <regex pattern="(?s)(?&lt;open&gt;&lt;add name=&quot;SiteSqlServer&quot; connectionString=&quot;)(?&lt;mode&gt;.+?)(?&lt;close&gt;&quot;.*? providerName=&quot;System.Data.SqlClient&quot; /&gt;)"                       
                       replacement="${open}$(DatabaseConnectionString)${close}"
                       evalVariablesInPattern="true"
                       evalVariablesInReplacement="true" /> 
                <regex pattern="dbUser=.*;dbPassword=.*;"                       
                       replacement=""
                       evalVariablesInPattern="true"
                       evalVariablesInReplacement="true" /> 
            </file>
        </files>
    </configuration>
    <runtime>
        <onStart>
            <webServer enableClassicPipelineMode="true">
                <application applicationPath="$(DotNetNukeAppPath)"
                             virtualDirectory="/" 
                             physicalPath="$(DotNetNukeHome)"
                             />
            </webServer>
        </onStart>
    </runtime>
</application>
  
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ���������[ IIS | 7.5 ]������������������������������������������������������������������ -->
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<application name="IIS" version="7.5" description="Generic Hosted Web Core Accelerator (no app-specific configuration)">
    <params>
        <param key="IisConnectionString" value="AcceleratorConnectionString" />
        <param key="IisDriveUri"         value="$(AcceleratorDrivePageBlobUri)" />
        <param key="IisLocalStorage"     value="LocalStorage" /> 
        <param key="IisEndPoint"         value="HttpIn" />
        <param key="IisSiteHome"         value="$(IisDrive)" />
        <param key="IisHostHeader"       value="$(Hostheader)" />
    </params>
    <dependencies>
        <localResources>
            <localStorage pathKey="IisCache" 
                          maximumSizeKey="IisCacheSize" 
                          configurationResourceName="$(IisLocalStorage)" />
            <endPoint portKey="IisRuntimePort" 
                      addressKey="IisRuntimeAddress" 
                      configurationEndPointName="$(IisEndPoint)" />
            <cloudDrive pathKey="IisDrive"
                        pageBlobUri="$(IisDriveUri)"
                        connectionString="$(IisConnectionString)"
                        cacheSize="1024"
                        readOnly="false"
                        copyBlob="false"
                        createIfNotExist="false"
                        />
        </localResources>
    </dependencies>
    <configuration>
        <environmentVariables>
            <environmentVariable name="PATH" 
                                 value="$(IisSiteHome)\bin;%PATH%" 
                                 evalEnvironmentVariablesInReplacement="true" />
        </environmentVariables>
    </configuration>
    <runtime>
        <onStart>
            <webServer>
                <binding protocol="Http" 
                         port="$(IisRuntimePort)" 
                         address="$(IisRuntimeAddress)" 
                         host="" />
                <!--
                <binding protocol="Http" port="$(IisRuntimePort)" address="*" host="" />
                <binding protocol="Http" port="$(IisRuntimePort)" address="$(IisRuntimeAddress)" host="$(IisHostHeader)" />
                -->
            </webServer>
        </onStart>
        <onRunning />
        <onStop />
    </runtime>
</application>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!-- ���������[ ROLE | 1.0 ]����������������������������������������������������������������� -->
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<role version="1.0" name="Accelerator">
    <applications>
    </applications>
    <roleRoot pathKey="RoleRoot" />
    <appRoot pathKey="AppRoot" />
    <diagnoticsStorage pathKey="DiagnosticLogs" />
    <localStorage pathKey="LocalStorage" />
</role>

</serviceAccelerator>